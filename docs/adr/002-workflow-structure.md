# ADR-002: 開発ワークフローの構成

## ステータス
一部決定

## コンテキスト
テンプレート基盤が完成した。次フェーズとして「調査→開発→リリース」のワークフローをskills/agentsで構築したい。
ただし、新規システム開発と機能開発で必要なフローが異なる。

## 2つのフロー

### 新規システム開発
1. 市場調査・競合分析
2. 要件定義
3. 技術選定（言語・フレームワーク）
4. アーキテクチャ設計
5. 仕様策定
6. 開発
7. レビュー・テスト

### 機能開発（既存プロジェクト）
1. 課題分析（Issue、ユーザー要望）
2. 既存コードベースの理解
3. 影響範囲の調査
4. 仕様策定
5. 開発
6. レビュー・テスト

### 共通部分と差分

| フェーズ | 新規 | 機能 | 共通？ |
|---------|------|------|:---:|
| 調査・要件定義 | 市場調査、競合分析 | Issue分析、ユーザー要望 | 半分 |
| 技術判断 | 言語・FW選定 | 既存コードベース理解 | 別物 |
| 仕様 | 仕様策定 | 仕様策定 | 共通 |
| 開発 | 実装 | 実装 | 共通 |
| 検証 | レビュー・テスト | レビュー・テスト | 共通 |

## 決定事項

### /research スキル（決定済み）

調査フェーズを単一の `/research [トピック]` スキルでカバーする。

| 判断 | 内容 | 理由 |
|------|------|------|
| 単一スキル | 3タイプ（市場/技術/コードベース）を1つのスキルで対応 | Boris思想: 1つで始めて必要なら分割 |
| 自動タイプ判定 | トピックからClaudeが調査タイプを推定 | ユーザーがタイプ名を覚える必要なし |
| 出力先 | RESEARCH.md（プロジェクトルート） | SDD慣例に従う |
| SDD接続 | Next StepsにSPEC.md作成を記載 | RESEARCH.md → SPEC.md → PLAN.md パイプライン |

### /spec スキル（方針決定、実装前）

仕様策定フェーズを `/spec [自由記述]` でカバーする。

| 判断 | 内容 | 理由 |
|------|------|------|
| 自由記述入力 | トピック、RESEARCH.md参照、Issue番号、口頭指示、またはそれらの組み合わせ | パターン分けせず1つのインターフェースで対応 |
| メインコンテキスト | `context: fork` なし。初稿生成後にユーザーと対話で練り上げる | 仕様は一発で決まらない。対話的に修正するのが自然 |
| 出力先 | SPEC.md（プロジェクトルート） | SDD慣例に従う。RESEARCH.md → SPEC.md パイプライン |

**入力パターン例:**
- `/spec ログイン機能` — 口頭のみ
- `/spec RESEARCH.mdを元にログイン機能` — リサーチ+口頭
- `/spec #123のIssueを元に` — Issue+口頭
- `/spec RESEARCH.mdと#123を踏まえてログイン機能` — 組み合わせ

**フロー:**
1. `/spec [自由記述]` で初稿生成
2. ユーザーと対話して練り上げ（「OAuth対応も入れて」「画面遷移はこうしたい」等）
3. 確定したらSPEC.mdに書き出し

**未決定:** SPEC.mdの出力構成（セクション構成、粒度）。ネット調査後に決定予定。

## Skills構成案

- **完成**: /fix-issue（Issue修正）、/research（調査）
- **次**: /spec（仕様策定）— 方針決定、SPEC.md構成調査後に実装
- **候補**: /review（レビュー）

## 未決定事項
- SPEC.mdの出力構成
- /review の粒度とスコープ
- git worktree活用（並行作業）
- Agent Teams活用（マルチエージェント協調）
